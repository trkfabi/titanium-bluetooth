/**
 * This file was auto-generated by the Titanium Module SDK helper for Android
 * Appcelerator Titanium Mobile
 * Copyright (c) 2009-2010 by Appcelerator, Inc. All Rights Reserved.
 * Licensed under the terms of the Apache Public License
 * Please see the LICENSE included with this distribution for details.
 *
 */
package ti.bluetooth;

import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothGattCharacteristic;
import android.bluetooth.BluetoothManager;
import android.content.Context;
import org.appcelerator.kroll.KrollModule;
import org.appcelerator.kroll.annotations.Kroll;
import org.appcelerator.titanium.TiApplication;
import ti.bluetooth.central.TiBluetoothCentralManagerProxy;

@Kroll.module(name = "TiBluetooth", id = "ti.bluetooth")
public class TiBluetoothModule extends KrollModule {

  @Kroll.constant public static final int MANAGER_STATE_POWERED_OFF = 10;

  @Kroll.constant public static final int MANAGER_STATE_POWERED_ON = 12;

  @Kroll.constant public static final int SCAN_MODE_BALANCED = 1;

  @Kroll.constant public static final int SCAN_MODE_LOW_LATENCY = 2;

  @Kroll.constant public static final int SCAN_MODE_LOW_POWER = 0;

  @Kroll.constant public static final int SCAN_MODE_OPPORTUNISTIC = -1;

  @Kroll.constant
  public static final int CHARACTERISTIC_PROPERTY_WRITE_WITH_RESPONSE =
      BluetoothGattCharacteristic.WRITE_TYPE_DEFAULT;

  @Kroll.constant
  public static final int CHARACTERISTIC_PROPERTY_WRITE_WITHOUT_RESPONSE =
      BluetoothGattCharacteristic.WRITE_TYPE_NO_RESPONSE;

  public TiBluetoothModule() { super(); }

  @Kroll.method
  public TiBluetoothCentralManagerProxy createCentralManager() {
    BluetoothManager bluetoothManager =
        (BluetoothManager)TiApplication.getInstance().getSystemService(
            Context.BLUETOOTH_SERVICE);
    BluetoothAdapter bluetoothAdapter = bluetoothManager.getAdapter();

    return bluetoothAdapter != null
        ? new TiBluetoothCentralManagerProxy(TiApplication.getInstance(),
                                             bluetoothAdapter)
        : null;
  }
}
